name: CI - Agent Worker

on:
  workflow_dispatch:

permissions:
  contents: read

jobs:
  ci:
    uses: jcttech/.github/.github/workflows/python-pipeline.yml@v1
    with:
      code-paths: |
        packages/agent-worker/**
        proto/**
        pyproject.toml
      package-dir: packages/agent-worker
      python-version: '3.13'
      setup-command: >-
        uv run python -m grpc_tools.protoc
        -I../../proto
        --python_out=src/agent_worker
        --grpc_python_out=src/agent_worker
        ../../proto/agent.proto
        && sed -i 's/^import agent_pb2/from . import agent_pb2/' src/agent_worker/agent_pb2_grpc.py
      enable-docker: false
      enable-release: false
